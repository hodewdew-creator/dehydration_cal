<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>수액속도 계산기 (Cats)</title>
  <meta name="description" content="고양이 탈수/유지/지속손실 기반 주입속도 계산">
  <style>
    :root{
      --blue:#1d4ed8; --muted:#64748b; --bg:#f8fafc; --card:#fff; --border:#e5e7eb;
    }
    *{box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:0;background:var(--bg);color:#0f172a;padding:12px}
    h2{margin:0 0 12px;font-size:1.32rem;color:#1d4ed8;text-align:center}
    h3{margin:0 0 8px;font-size:1.06rem;color:#1d4ed8;display:flex;align-items:center;gap:12px}
    .card{background:#fff;border:1px solid var(--border);border-radius:12px;padding:12px;margin-bottom:12px;box-shadow:0 2px 6px rgba(0,0,0,.04)}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .ibox{border:2px solid var(--blue);border-radius:10px;padding:10px;background:#f9fafb;min-width:140px;flex:1}
    .ibox label{display:block;font-size:.92rem;margin-bottom:4px;color:var(--blue)}
    .ibox input[type=number], .ibox select{width:100%;padding:10px;font-size:1rem;border:1px solid var(--border);border-radius:8px;background:#fff}
    .ibox input:focus, .ibox select:focus{outline:none;border-color:var(--blue)}
    .hint{font-size:.8rem;color:var(--muted)}
    .note{font-size:.8rem;color:#6b7280;margin-top:6px}
    .pillbar{display:flex;gap:8px;flex-wrap:wrap}
    .pill{padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:#fff;cursor:pointer}
    .pill.active{background:var(--blue);color:#fff;border-color:var(--blue)}
    .slider-wrap{display:flex;align-items:center;gap:10px}
    input[type=range]{width:100%}
    .big{font-weight:700;color:var(--blue)}
    .small{font-size:.82rem;color:var(--muted)}
    .split{height:1px;background:var(--border);margin:12px 0}
  </style>
</head>
<body>
  <h2>수액속도 계산기</h2>

  <!-- 1) 환자 & 체중 -->
  <div class="card">
    <h3>🐾 체중</h3>
    <div class="row">
      <div class="ibox" style="max-width:220px">
        <label for="bw">체중 (kg)</label>
        <input id="bw" type="number" step="0.1" placeholder="체중 (필수 입력)" onfocus="this.placeholder=''" onblur="if(this.value==''){this.placeholder='체중 (필수 입력)'}">
      </div>
    </div>
  </div>

  <!-- 2) 탈수 (선택입력) -->
  <div class="card">
    <h3>💧 탈수 <span class="small">(선택입력)</span>
      <label style="display:flex;align-items:center;gap:6px;font-weight:normal;font-size:.9rem">
        <input id="noDehy" type="checkbox" checked>
        <span>탈수 없음</span>
      </label>
    </h3>
    <div class="row">
      <div class="ibox" style="min-width:240px">
        <label>% 탈수 (5~12%)</label>
        <div class="slider-wrap">
          <input id="dehy" type="range" min="5" max="12" step="0.5" value="7">
          <span id="dehyLab" class="big">7%</span>
        </div>
        <div class="hint">결핍량 = 체중 × (%/100) × 1000</div>
      </div>
      <div class="ibox" style="min-width:260px">
        <label>보충 시간</label>
        <div class="pillbar" id="rtBtns">
          <div class="pill" data-h="6">6 h</div>
          <div class="pill active" data-h="12">12 h</div>
          <div class="pill" data-h="18">18 h</div>
          <div class="pill" data-h="24">24 h</div>
        </div>
        <div class="hint">버튼 탭으로 보충시간 선택</div>
      </div>
    </div>
    <div class="split"></div>
    <div class="row">
      <div class="ibox">
        <label>결핍량 (mL)</label>
        <div id="deficit" class="big">-</div>
      </div>
      <div class="ibox">
        <label>시간당 결핍 보충속도 (mL/h)</label>
        <div id="deficitHr" class="big">-</div>
      </div>
    </div>

    <!-- 탈수율 가이드: 기본 닫힘 -->
    <details style="margin-top:10px">
      <summary style="cursor:pointer;color:#374151;font-weight:400;font-size:0.9rem">
        ▶ 신체검사 상 추정 탈수율 가이드 (열기)
      </summary>
      <div class="note" style="margin-top:8px">
        <ul style="margin:6px 0 0 18px">
          <li><strong>&lt;5%</strong> — <strong>임상적으로 감지 어려움</strong></li>
          <li><strong>5~6%</strong> — 피부 긴장도 <strong>약간 변화</strong></li>
          <li><strong>6~8%</strong> — 피부 긴장도 경미하게 감소, <strong>점막 건조</strong></li>
          <li><strong>8~10%</strong> — 피부 긴장도 <strong>명확히 감소</strong>, <strong>안구 함몰</strong></li>
          <li><strong>10~12%</strong> — 피부 탄력 <strong>거의 소실</strong>로 <strong>지속적 텐팅</strong>, <strong>각막 혼탁</strong>, <strong>저혈량증 소견</strong></li>
          <li><strong>&gt;12%</strong> — <strong>저혈량성 쇼크</strong>, <strong>생명 위협</strong> 가능</li>
        </ul>
        <div style="margin-top:8px">
          <em>참고:</em> 임상 소견과 실제 탈수율의 상관에는 개인차가 커서 이 표는 <strong>추정치</strong>입니다.
        </div>
      </div>
    </details>

  </div>

  <!-- 3) 유지수액 (고정공식) -->
  <div class="card">
    <h3>🔁 유지수액</h3>
    <div class="hint" style="margin-bottom:6px"> Maint(ml/h) = (80 × kg^0.75) / 24</div>
    <div class="row">
      <div class="ibox">
        <label>유지속도 (mL/h)</label>
        <div id="maint" class="big">-</div>
      </div>
    </div>
  </div>

  <!-- 4) 지속손실 (선택입력) -->
  <div class="card">
    <h3>➕ 지속 손실 <span class="small">(선택입력, mL/h)</span></h3>
    <div class="row">
      <div class="ibox" style="max-width:220px">
        <label for="ongoing">지속손실 (mL/h)</label>
        <input id="ongoing" type="number" step="1" placeholder="없으면 비워두기" value="0">
      </div>
    </div>
  </div>

  <!-- 5) 결과 -->
  <div class="card">
    <h3>🚀 주입속도 결과</h3>
    <div class="row">
      <div class="ibox">
        <label>초기 속도 (mL/h)</label>
        <div id="rateInit" class="big">-</div>
      </div>
      <div class="ibox">
        <label>보충 종료 후 (mL/h)</label>
        <div id="rateAfter" class="big">-</div>
      </div>
    </div>
    <div class="note">표시: 초기속도(보충기간) → 종료 후 유지/지속손실 포함 속도</div>
  </div>

<script>
  const $ = (id)=>document.getElementById(id);
  const fmt = (x,d=0)=> (isNaN(x)? '-' : Number(x).toFixed(d));

  const bw=$('bw'), dehy=$('dehy'), dehyLab=$('dehyLab'), noDehy=$('noDehy');
  const rtBtns=$('rtBtns');
  const deficit=$('deficit'), deficitHr=$('deficitHr');
  const maint=$('maint'), ongoing=$('ongoing');
  const rateInit=$('rateInit'), rateAfter=$('rateAfter');

  let replH = 12;
  rtBtns.querySelectorAll('.pill').forEach(p=>{
    p.addEventListener('click',()=>{
      rtBtns.querySelectorAll('.pill').forEach(x=>x.classList.remove('active'));
      p.classList.add('active');
      replH = parseInt(p.dataset.h,10);
      recalcAll();
    });
  });

  function calcMaint(BW){
    return (80 * Math.pow(BW,0.75)) / 24; // mL/h
  }

  function recalcAll(){
    const BW = parseFloat(bw.value);
    if(isNaN(BW) || BW<=0){
      [maint,deficit,deficitHr,rateInit,rateAfter].forEach(el=>el.textContent='-');
      return;
    }

    let deficitMl=0, deficitPerHr=0;
    if(!noDehy.checked){
      dehyLab.textContent = `${dehy.value}%`;
      deficitMl = BW * (parseFloat(dehy.value)/100) * 1000;
      deficitPerHr = deficitMl / replH;
    } else {
      dehyLab.textContent = '0%';
    }

    deficit.textContent = fmt(deficitMl,0);
    deficitHr.textContent = fmt(deficitPerHr,1);

    const m = calcMaint(BW);
    maint.textContent = fmt(m,1);

    const on = parseFloat(ongoing.value||'0')||0;

    const rInit = m + deficitPerHr + on;
    const rAfter = m + on;
    rateInit.textContent = fmt(rInit,1);
    rateAfter.textContent = fmt(rAfter,1);
  }

  ['input','change'].forEach(evt=>{
    [bw,dehy,ongoing,noDehy].forEach(el=> el.addEventListener(evt, recalcAll));
  });

  recalcAll();
</script>
</body>
</html>

